---
title: "【Laravel】リソースコントローラーでサクッとCRUDを作成する"
emoji: "🐿️"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["Laravel", "PHP", "Tech"]
published: false
---

- リソースコントローラーについての説明
- 環境構築
- コントローラー作成
- ルーティング定義(Route::resource)
- それぞれに簡易的な処理を書く
- アクセスして確認

# この記事について

何か改善点などあればご指摘ください 🙏

# リソースコントローラーとは

> アプリケーション内の各Eloquentモデルを「リソース」と考える場合、通常、アプリケーション内の各リソースに対して同じ一連のアクションを実行します。たとえば、アプリケーションにPhotoモデルとMovieモデルが含まれているとします。ユーザーはこれらのリソースを作成、読み取り、更新、または削除できるでしょう。
>このようなコモン・ケースのため、Laravelリソースルーティングは、通常の作成、読み取り、更新、および削除("CRUD")ルートを１行のコードでコントローラに割り当てます。
https://readouble.com/laravel/10.x/ja/controllers.html

CRUD処理へのルーティングを簡単に作成してくれるもののようです🤔

# 実践

## 環境構築

Laravelの環境はLaravel Sailで構築します。  
（`with=mysql`と指定していますが、何も指定しないとRedisやmeilisearchなど諸々追加されてしまうので）
`curl -s "https://laravel.build/example-app?with=mysql" | bash`

`./vendor/bin/sail up`でコンテナを起動します。

## コントローラー作成

コントローラーの作成時に`--resource`を指定すると、アクションがすでに定義されているコントローラーが作成されます。
今回は、モデルのインスタンスを自動で取得してきて欲しいので、`--model`も指定します😺

```shell
# php artisan make:controller TestController --model=Test --resource

 ┌ A App\Models\Test model does not exist. Do you want to generate it? ┐
 │ ● Yes / ○ No                                                        │
 └─────────────────────────────────────────────────────────────────────┘

INFO  Model [app/Models/Test.php] created successfully.  

INFO  Controller [app/Http/Controllers/TestController.php] created successfully.  
```

Modelを作成していない場合は作成してくれるようです。

↓のようなControllerが生成されました。

```PHP:app/Http/Controller/TestController.php
<?php

namespace App\Http\Controllers;

use App\Models\Test;
use Illuminate\Http\Request;

class TestController extends Controller
{
    /**
     * Display a listing of the resource.
     */
    public function index()
    {
        //
    }

    /**
     * Show the form for creating a new resource.
     */
    public function create()
    {
        //
    }

    /**
     * Store a newly created resource in storage.
     */
    public function store(Request $request)
    {
        //
    }

    /**
     * Display the specified resource.
     */
    public function show(Test $test)
    {
        //
    }
```

他にも`edit`,  `update`, `destroy`が作成されていました。

## ルーティング定義

`routes/web.php`にルートを定義します。

```PHP:routes/web.php
<?php

use Illuminate\Support\Facades\Route;
use App\Http\Controllers\TestController;

Route::resource('test', TestController::class);

```

## 確認

`php artisan route:list`で定義されているルートを確認してみます😺

```shell
# php artisan route:list

  POST            _ignition/execute-solution .................. ignition.executeSolution › Spatie\LaravelIgnition › ExecuteSolutionController
  GET|HEAD        _ignition/health-check .............................. ignition.healthCheck › Spatie\LaravelIgnition › HealthCheckController
  POST            _ignition/update-config ........................... ignition.updateConfig › Spatie\LaravelIgnition › UpdateConfigController
  GET|HEAD        api/user .................................................................................................................. 
  GET|HEAD        sanctum/csrf-cookie ..................................... sanctum.csrf-cookie › Laravel\Sanctum › CsrfCookieController@show
  GET|HEAD        test .................................................................................... test.index › TestController@index
  POST            test .................................................................................... test.store › TestController@store
  GET|HEAD        test/create ........................................................................... test.create › TestController@create
  GET|HEAD        test/{test} ............................................................................... test.show › TestController@show
  PUT|PATCH       test/{test} ........................................................................... test.update › TestController@update
  DELETE          test/{test} ......................................................................... test.destroy › TestController@destroy
  GET|HEAD        test/{test}/edit .......................................................................... test.edit › TestController@edit

                                                                                                                          Showing [12] routes
```

（上の5つは置いといて）ちゃんとルートが定義されてますね！


実際に呼び出せるかも確認してみます。
```PHP:app/Http/Controller/TestController.php
public function index()
    {
        exit("hoge");
    }
```

![アクセスして確認](https://storage.googleapis.com/zenn-user-upload/3cb1057d6e52-20240123.png)

`index`が呼び出されてますね！

# 

# おわりに
